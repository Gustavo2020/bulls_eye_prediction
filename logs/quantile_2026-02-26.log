PyTorch device : cuda
  GPU           : NVIDIA GeForce RTX 5080 Laptop GPU
  VRAM          : 16.6 GB
  CUDA version  : 12.8

Model dir : YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model

=======================================================
PHASE 1 — DATA INGESTION
=======================================================
Existing data: 96,843 rows — last game: 2026-02-26
Checking for new 2025-26 games (skipping 4,530 known)...
      200/409 probed  |  81 player-game rows so far
      400/409 probed  |  81 player-game rows so far
  → No new games since last update.

=======================================================
PHASE 2 — FEATURE ENGINEERING
=======================================================
  Building rolling player features...
  Building volatility features (v2)...
  Building team defensive metrics...
  → Feature dataset: (98072, 56)

=======================================================
PHASE 3 — MODEL TRAINING (Quantile XGBoost)
=======================================================
Training rows : 94,682  (dropped 3,390 NaN rows)
  Train : 75,745 rows
  Val   : 18,937 rows  (chronological 80/20)

  ── Training q10 (α=0.1) ──
[0]	validation_0-quantile:0.91041
[50]	validation_0-quantile:0.67558
[100]	validation_0-quantile:0.66253
[150]	validation_0-quantile:0.66193
[165]	validation_0-quantile:0.66215
YOUR_HOME_DIR/MSADS_/Time_series_31006/tsenvi/lib/python3.12/site-packages/xgboost/core.py:751: UserWarning: [06:25:17] WARNING: /__w/xgboost/xgboost/src/common/error_msg.cc:62: Falling back to prediction using DMatrix due to mismatched devices. This might lead to higher memory usage and slower performance. XGBoost is running on: cuda:0, while the input data is on: cpu.
Potential solutions:
- Use a data structure that matches the device ordinal in the booster.
- Set the device for booster before call to inplace_predict.

This warning will only be shown once.

  return func(**kwargs)
  → Saved: YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/nba_xgb_q10_quantile.json

  ── Training q50 (α=0.5) ──
[0]	validation_0-quantile:3.00398
[50]	validation_0-quantile:2.00707
[100]	validation_0-quantile:1.99207
[150]	validation_0-quantile:1.99159
[191]	validation_0-quantile:1.99243
  q50  → MAE: 3.985  RMSE: 5.398  R²: 0.382
  → Saved: YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/nba_xgb_q50_quantile.json

  ── Training q90 (α=0.9) ──
[0]	validation_0-quantile:1.80050
[50]	validation_0-quantile:1.09145
[100]	validation_0-quantile:1.07617
[150]	validation_0-quantile:1.07628
[151]	validation_0-quantile:1.07635

  Raw [q10–q90] coverage : 73.3%  (target ~80%)  avg width: 12.1 pts  ← before calibration
  → Saved: YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/nba_xgb_q90_quantile.json


=======================================================
PHASE 3.5 — PLAYER-LEVEL INTERVAL CALIBRATION (v2)
=======================================================
  Rationale: the global q10/q90 models learn average dataset variance.
  A consistent role player (e.g. Yabusele) ends up with the same
  interval width as a volatile star. Per-player calibration shrinks
  intervals for consistent players and widens them for volatile ones
  so that each player individually achieves ~80% empirical coverage.

  Global fallback scale factor : 0.9694
  Players calibrated : 238  (≥10 val games each)
  Players using global fallback : 44

  Sample calibration factors (factor < 1.0 → narrow, > 1.0 → wide):
    Mark Williams                 factor: 0.9850  ≈ unchanged
    Jeremy Sochan                 factor: 1.0724  ← widened
    Wendell Moore Jr.             factor: 0.8048  ← narrowed
    Kendall Brown                 factor: 0.6006  ← narrowed
    Kennedy Chandler              factor: 0.7368  ← narrowed
    Jalen Williams                factor: 0.9849  ≈ unchanged
    Orlando Robinson              factor: 0.8027  ← narrowed
    Patrick Baldwin Jr.           factor: 0.8793  ← narrowed
    Walker Kessler                factor: 0.8641  ← narrowed
    Jaylin Williams               factor: 0.8964  ← narrowed

  Post-calibration [q10–q90] coverage : 79.9%  (target ~80%)
  Post-calibration avg interval width : 11.2 pts  (was 12.1 pts)

  → Calibration factors saved : YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/calibration_factors.json

=======================================================
PHASE 4 — PREDICTIONS HISTORY
=======================================================
  → 94,682 rows saved to YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/predictions_history_quantile.csv
  → Val interval coverage [q10–q90] : 80.9%  (target ~80%)
  → Val avg interval width           : 11.2 pts

=======================================================
PHASE 5 — TOMORROW'S PREDICTIONS (CHI)
=======================================================
Fetching season schedule from cdn.nba.com...
  → CDN schedule failed: 403 Client Error: Forbidden for url: https://cdn.nba.com/static/json/staticData/scheduleLeagueV2_1.json
  → Trying ESPN API fallback...
  → CHI has no game on 2026-02-27 [ESPN]

=======================================================
PHASE 6 — BULLS DASHBOARD JSON
=======================================================
  → Dashboard saved : YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/bulls_dashboard_quantile.json
  → Recent games    : 10
  → Next game       : N/A

=======================================================
DONE
=======================================================
  q50 MAE    : 3.985 pts  ← compare vs baseline 4.010
  q50 RMSE   : 5.398 pts
  q50 R²     : 0.382

  Interval [q10–q90] — RAW       : coverage 73.3%  | width 12.1 pts
  Interval [q10–q90] — CALIBRATED: coverage 79.9%  | width 11.2 pts  ← target ~80%

  Output files:
    YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/df_raw.parquet
    YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/df_model_quantile.parquet
    YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/nba_xgb_q10_quantile.json  ← q10 model
    YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/nba_xgb_q50_quantile.json  ← q50 model
    YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/nba_xgb_q90_quantile.json  ← q90 model
    YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/calibration_factors.json  ← per-player scale factors
    YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/predictions_history_quantile.csv
    YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/bulls_dashboard_quantile.json  ← web service JSON
    YOUR_HOME_DIR/MSADS_/Time_series_31006/FINAL_PROJECT_VF/model/meta_quantile.json
